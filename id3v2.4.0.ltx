
\documentclass{article}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc} % любая желаемая кодировка
\usepackage[russian,english]{babel}
\usepackage[pdftex,unicode]{hyperref}

\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.



\makeatother

\usepackage{babel}
\begin{document}

Информационный стандарт

Документ:id3v2.4.0-structure

M. Nillson

1.11.2000

Перевод:
elp87

Агуст 2013

\begin{center}
Теги ID3 версия 2.4.0 - Основная структура
\par\end{center}


\part*
{
Статус документа
}


\paragraph
{
Этот документ является информационным стандартом и заменяет стандарт ID3v2.3.0 [ID3v2].
 Официальный стандарт будет использовать другой номер ревизии даже если содержание будет идентично с документом. 
Материалы этого документа могут меняться для пояснений, но не для добавления или изменения функциональности.
}


\paragraph
{
Распостранение этого документа без ограничений
}


\part*
{
Краткое описание
}


\paragraph
{
Этот документ описывает основную структуру ID3v2.4.0, который является исправленной версией информационного стандарта ID3v2 версии 2.3.0. 
ID3v2 предлагает гибкий способ хранения аудио мета-информации внутри аудио файла. Информация может быть технической, как уравнения кривых, так и название, исполнитель, копирайт и т.д.
}


\paragraph
{
ID3v2.4.0 создан наиболее возможно близким к ID3v2.3.0 в целях обеспечения осуществления исправления наиболее просто
}


\section
{
Содержание
}


\section
{
Условные обозначения в документе
}

\paragraph
{
Текст внутри “” является текстовой строкой в точности, как она отображается в тэге. 
Числа, начинающиеся с \$ - шестнадцатиричные, а числа, начинающиеся с \% - двоичные. 
\$xx используется для обозначения байта с неизвестным содержимым. 
\%x используется для обозначения бита с неизвестным содержимым. 
Наибольший значащий бит (MSB) байта называется 'бит 7', а наименьший значащий бит (LSB) называется 'бит 0'.
}


\paragraph
{
Тег - это весь тег, описанный в этом документе. 
Фрейм - блок информации тега. 
Тег состоит из заголовка, фреймов и необязательных вложений. 
Поле - это часть информации; одно значение, строка и т.д. 
Числовая строка - это строка состоящая только из символов “0123456789”.
}


\paragraph
{
Ключевые слова как "ДОЛЖЕН", "НЕ ДОЛЖЕН", "НЕОБХОДИМО", "ОБЯЗАН", "НЕ ДОЛЖЕН", "СЛЕДУЕТ", "НЕ СЛЕДУЕТ", "РЕКОМЕНДУЕТСЯ", "МОЖЕТ быть"и "НЕОБЯЗАТЕЛЬНО" в этом документе следует интерпретировать, как описано в RFC 2119 [KEYWORDS].
}


\section
{
Обзор ID3v2
}

\paragraph
{
ID3v2 - это общий формат тегов для аудио, который делает возможным хранение мета-данных об аудио внутри аудио-файла. 
Тег ID3v2, описанный в этом документе, в основном нацелен на файлы, кодированыые в MPEG-1/2 layer I, MPEG-1/2 layer II, MPEG-1/2 layer III и MPEG-2.5, но может работать и с другими типами кодировок аудио или как самостоятельный формат мате-данных аудио.
}


\paragraph
{
ID3v2 разработан наиболее возможно гибким и расширяем для удовлетворения в потребности новой мета-информации, которая может возникнуть. 
Для этого ID3v2 построен, как контейнер для нескольких информационных блоков, названных фреймами, формат которых не должен быть известен программному обеспечению, которое обнаруживает их. 
В начале каждого фрейма находится уникальный и предопределенный идентификатор, размер дескриптора, который позволяет программному обеспечению пропускать неизвестные фреймы и поле флагов. 
Флаги описывают детали кодировки, и если фрейм должен находиться в теге, это должно быть неизвестно программному обеспечению, если файл изменен.
}


\paragraph
{
Порядок битов в ID3v2 - сначала наиболее значащий бит (MSB). 
Порядок байтов в многобайтовых числах - сначала наиболее значащий байт (т.е. \$12345678 будет кодироваться как \$12 34 56 78), также известный как порядок от старшего к младшему или сетевым порядком байтов.
}


\paragraph
{
Общая структура тегов
}
\begin{enumerate}
\item Заголовок (10 байтов)
\item Расширенный заголовок (переменная длина, НЕОБЯЗАТЕЛЬНО)
\item Фреймы (переменная длина)
\item Дополнение (переменная длина, НЕОБЯЗАТЕЛЬНО)
\item Нижний колонтитул (10 байт, НЕОБЯЗАТЕЛЬНО)
\end{enumerate}


\paragraph
{
В общем, дополнение и нижний колонтитул являются взаимоисключающими. Смотрите детали в разделах 3.3, 3.4 и 5
}


\subsection
{
Заголовок ID3v2
}


\paragraph
{
Первая часть тега ID3v2 - 10 байтовый заголовок тега, сформулированный следующим образом
}

\begin{center}
\begin{tabular} {ll}
Идентификатор ID3v2/файла & "ID3" \\
Версия ID3v2 & \$04 00 \\
Флаг ID3v2 & \%abcd0000 \\
Размер ID3v2 & 4 * \%0xxxxxxx \\
\end{tabular}
\end{center}

\paragraph
{
Первые три байта тега всегда "ID3" для идентификации, что это тег ID3v2, непосредственно за которым идут два байта версии.
Первый байт версии ID3v2 - это его основная версия, в то время как второй байт - номер ревизии.
В данном случае это ID3v2.4.0.
Все ревизии обратно совместимы, тогда как основные версии - нет.
Если программное обеспечение с поддержкой ID3v2.4.0 или ниже должно встретить версию 5 или выше, то оно должно просто пропустить весь тег.
Версия или ревизия никогда не будет \$FF.
}

\paragraph
{
За номером версии следует поле флагов, из которых в настоящее время используется четыре флага
}
\newcounter{N}
\begin{list}{\alph{N}}{\usecounter{N}} 
\item Рассинхронизация \\ 
Бит 7 в флагах ID3v2 показывает используется ли рассинхронизация на всех фреймах (см.раздел 6.1); установленный бит означает использование.

\item Расширенный заголовок \\
Второй бит (бит 6) показывает идет ли за заголовко расширенный заголовок.
Расширенный заголовок описан в разделе 3.2.
Установленный бит указывает на наличие расширенного заголовка.

\item Экспериментальный индикатор \\
Третий бит (бит 5) используется как 'экспериментальный индикатор'.
Этот флаг ДОЛЖЕН всегда быть установлен, если тег находится в экспериментальной стадии.

\item Наличие нижнего колонтитула \\
Бит 4 показывает, что нижний колонтитул (раздел 3.4) присутствует в самом конце тега.
Установленный бит показывает наличие нижнего колонтитула.
\end{list}

\paragraph
{
Все остальные флаги ДОЛЖНЫ быть очищены.
Если хотя бы один из этих неопределенных флагов установлен, тег может быть нечитабельным для парсера, который не знает функцию флага.
}

\paragraph
{
Размер тега ID3v2 хранится, как 32-битное syncsafe целое
\protect\footnote{http://en.wikipedia.org/wiki/Synchsafe}(раздел 6.2)
, дающее в сумме 28 эффективных бит (означающие до 256 мб).
}

\paragraph
{
Размер тега ID3v2 - это сумма длин расширенного заголовка, дополнения и фреймов после рассинхронизации.
Если нижний колонтитул присутствует, то это равняется ("общий размер" - 20) байт, в противном случае ("общий размер" - 10) байт.
}

\paragraph
{
Тег ID3v2 можно обнаружить по следующему шаблону:
}
\begin{center}
\$ 49 44 33 yy yy xx zz zz zz zz
\end{center}
\paragraph
{
Где yy - меньше, чем \$FF, xx - байт флага, а zz - меньше, чем \$80
}

\subsection
{
Расширенный заголовок
}

\paragraph
{
Расширенный заголовок содержит информацию, которая может обеспечить дальнейшее проникновение в структуру тега,
но не является необходимой для правильного анализа информации тега;
следовательно, расширенный заголовок является необязательным.
}

\begin{center}
\begin{tabular} {ll}
Размер расширенного заголовка & 4 * \%0xxxxxxx \\
Количество байт флага & \$01 \\
Расширенные флаги & \$xx \\
\end{tabular}
\end{center}

\paragraph
{
Где "Размер расширенного заголовка" - это размер всего расширенного заголовка, хранящийся как 32-битное synchsafe целое.
Расширенный заголовок, таким образом, никогда не может иметь размер менее 6 байт.
}

\paragraph
{
Поле расширенного флага с его размером, описанным "количество байт флага" определяется как:
}

\begin{center}
\%0bcd0000
\end{center}

\paragraph
{
Каждый флаг, установленный в расширенном заголовке, иммет прикрепленные данные, которые идут в порядке, в котором встречаются флаги
(т.е. данные для флага 'b' идут до данных для флага 'c').
Сброшенные флаги не могут иметь прикрепленные данные.
Все неизвестные флаги ДОЛЖНЫ быть сброшены, и соответствующие данные удалены, если тег изменился.
}

\paragraph
{
Данные каждого установленного флага начинаются с байта длины, который содержит значение от 0 до 128 (\$00-\$7f),
за которым следуют данные, которые имеют длину поля, отображаемую байтом длины.
Если флаг не имеет прикрепленных данных, значение \$00 используется как байт длины
}

\begin{description}
\item [b] Тег-обновление \\
Если этот флаг установлен, то настоящий тег - обновление тега, найденного ранее в настоящем файле или потоке.
Если фреймы, определенные как уникальные, найдены в настоящем теге, они переопределяют любые соответствующие фреймы, найденные в более раннем теге.
Этот флаг не имеет соответствующих данных \\
\begin{tabular} {ll}
Длина данных флага & \$00 \\
\end{tabular}

\item [c] Наличие данных CRC \\
Если этот флаг установлен, то в расширенный заголовок включены данные CRC-32 [ISO-3309].
CRC расчитывается на все данные между заголовком и нижним колонтитулом, как указано в поле длины тега в заголовке, кроме расширенного заголовка.
Обратите внимание, что оно включает дополнение (если оно есть), но исключает нижний колонтитул.
CRC-32 хранится как 35 битное synchsafe целое,оставляя верхние 4 бита всегда обнуленными \\
\begin{tabular} {ll}
Длина данных флага & \$05 \\
Общий фрейм CRC & 5 * \%0xxxxxxx
\end{tabular}

\item [d] Ограничения тега \\
Для некоторых приложение может быть желательно , огранить тег большими способами, нежели налагаемыми спецификацией ID3v2
Обратите внимание, что наличие этих ограничений не влияет на то, как тег декодируется, только, как он был ограничен перед кодированием.
Если флаг установлен, на тег накладываются следующие ограничения: \\
\begin{tabular} {ll}
Длина данных флага & \$01 \\
Общий фрейм CRC & \%ppqrrstt
\end{tabular}

\item [p] Ограничения на размер тега \\
\begin{tabular} {ll}
00 & Не более 128 кадров и 1мб общего размера тега \\
01 & Не более 64 кадров и 128кб общего размера тега \\
10 & Не более 32 кадров и 40кб общего размера тега \\
11 & Не более 32 кадров и 4кб общего размера тега \\
\end{tabular}

\item [q] Ограничения на кодировку текста \\
\begin{tabular} {ll}
0 & Без ограничений \\
1 & Строки кодируются только в ISO-8859-1 [ISO-8859-1] или UTF-8 [UTF-8] \\
\end{tabular}

\item [r] Ограничения на размер текстового поля \\
\begin{tabular} {ll}
00 & Без ограничений \\
01 & Строка не длинее 1024 символов \\
10 & Строка не длинее 128 символов \\
11 & Строка не длинее 30 символов \\
\end{tabular}
\\
Обратите внимание, что ничего не сказано о том, сколько байт используется для представления этих символов, поскольку это зависит от кодирования. 
Если текстовый фрейм состоит более чем из одной строки, сумма строки ограничена, как указано.

\item [s] Ограничение на кодировку изображения\\
\begin{tabular} {ll}
0 & Без ограничений \\
1 & Изображения кодируются только в PNG [PNG] или JPEG [JFIF] \\
\end{tabular}

\item [t] Ограничения на размер изображения\\
\begin{tabular} {ll}
00 & Без ограничений \\
01 & Все изображения - 256х256 пиксел или менее \\
10 & Все изображения - 64х64 пиксел или менее \\
11 & Все изображения - именно 64x64 пикселей, если не требуется иначе. \\
\end{tabular}
\end{description}

\subsection
{
Нижний колонтитул ID3v2
}

\paragraph
{
НЕОБЯЗАТЕЛЬНО включать дополнение после последнего фрейма (в конце тега ID3v2), делая размер всех кадров вместе меньше размера, заданного в теге заголовка.
Возможной целью этого дополнения является разрешение на добавление нескольких дополнительных фреймов или расширение существующих фреймов внутри тега без необходимости переписывать весь файл.
Значение байтов вложения должно быть \$00.
Тег НЕ ДОЛЖЕН иметь каких-либо дополнений между фреймами или между заголовком тега и фреймами.
Кроме того, в нем НЕ ДОЛЖНО быть каких-либо дополнений, когда в тег добавлен нижний колонтитул тега.
}

\subsection
{
Нижний колонтитул ID3v2
}

\paragraph
{
Для увеличения скорости обнаружения тега ID3v2 при поиске с конца файла, в тег может быть добавлен нижний колонтитул.
НЕОБХОДИМО добавлять нижний колонтитул к прикреаленному тегу, т.е. тегу, находящемся после всех аудио-данных.
Нижний колонтитул является копией заголовка, но имеет другой идентификатор
}

\begin{center}
\begin{tabular} {ll}
Идентификатор ID3v2/файла & "ID3" \\
Версия ID3v2 & \$04 00 \\
Флаг ID3v2 & \%abcd0000 \\
Размер ID3v2 & 4 * \%0xxxxxxx \\
\end{tabular}
\end{center}

\section
{
Обзор фрейма ID3v2
}

\paragraph
{
Все фреймы ID3v2 состоят из одного заголовка фрейма, за которым следует один или более полей, содержащих фактическую информацию.
Заголовок содержит всегда 10 байтов и сформулирован следующим обрахом:
}

\begin{center}
\begin{tabular} {ll}
ID фрейма & \$xx xx xx xx (4 символа) \\
Размер & 4 * \%0xxxxxxx \\
Флаги & \$xx xx \\
\end{tabular}
\end{center}

\paragraph
{
ID фрейма состоит из заглавных символов A-Z и 0-9.
Идентификаторы, начинающиеся с "X", "Y" и"Z" - экспериментальные фреймы и свободны в использовании для всех, без необходимости устанавливать экспериментальный бит в заголовок тега.
Имейте в виду, что кто-то другой может использовать тот же идентификатор, что вы.
Все остальные идентификаторы  или используются, или зарезервированы для будущего использования.
}

\paragraph
{
За ID фрейма следует размер дескриптора, содержащий размер данных в последнем фрейме после кодирования, сжатия и рассинхронизации.
Размер не учитывает заголовок фрейма ('общий размер фрейма' - 10 байт) и хранится как 32-битное synchsafe целое.
}

\paragraph
{
После размера дескриптора в заголовке фрейма идет два байта флагов.
Эти флаги описаны в разделе 4.1
}

\paragraph
{
Нет фиксированного порядка фрейма, идущих в теге, но желательно чтобы фреймы были расположены в порядке значимости для распознования файла.
Пример такого порядка: UFID, TIT2, MCDI, TRCK ...
}

\paragraph
{
Тег ДОЛЖЕН содержать по меньшей мере один фрейм.
Фрейм должен быть по меньшей мере размером 1 байт, не считая заголовка.
}

\paragraph
{
Если не указано другое, то строки, включая числовые строки и URL [URL], представляются в виде ISO-8859-1[ISO-8859-1] символов в диапазоне \$20 - \$FF.
Такие строки представлены в описании фрейма как <text string> или <full text string>, если разрешены переносы строк.
Если не указано другое, символ переноса строки заперещен.
В ISO-8859-1 символ переноса представлен, когда он разрешен, только как \$0A.
}

\paragraph
{
Кадры, которые разрешают разные типы кодировки текста содержат байт описания кодировки текста.
Возможные кодировки:
}

\begin{center}
\begin{tabular} {lp{15cm}}
\$00 & ISO-8859-1 [ISO-8859-1]. Заканчивается на \$00. \\
\$01 & UTF-16 [UTF-16] кодированное в Unicode [UNICODE] с BOM
\footnote[2]{http://ru.wikipedia.org/wiki/Byte\_order\_mark}.
Все строки в этом кадре ДОЛЖНЫ иметь этот же порядок байтов. Заканчивается на \$00 00 \\
\$02 & UTF-16BE [UTF-16] кодированное Unicode [UNICODE] без BOM. Заканчивается на \$00 00 \\
\$03 & UTF-8 [UTF-8] одированное Unicode [UNICODE]. Заканчивается на \$00. \\
\end{tabular}
\end{center}

\paragraph
{

}

\end{document}
}
